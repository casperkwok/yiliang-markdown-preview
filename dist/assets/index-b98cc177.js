var e=Object.defineProperty,t=(t,o,n)=>(((t,o,n)=>{o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n})(t,"symbol"!=typeof o?o+"":o,n),n);import{u as o,r as n,j as r,e as i,F as l,L as s,f as a,R as d}from"./react-vendor-b5324e8f.js";import{t as c,T as u}from"./ui-vendor-1b98d97d.js";import{u as p,E as h,N as m,C as f}from"./ui-components-af130aa6.js";import{h as g,P as v,m as x}from"./vendor-c6957c4b.js";import{c as b,a as y,i as k}from"./utils-2ed1ee2c.js";import{p as w}from"./lark-vendor-be110709.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const C="#212529",S=({content:e})=>{const{t:t}=o(),{handleCopy:s}=(()=>{const{t:e}=o(),[t,r]=n.useState(C);n.useEffect((()=>{const e=e=>{const t=e;t.detail&&t.detail.color&&r(t.detail.color)},t=getComputedStyle(document.documentElement).getPropertyValue("--themeColor").trim();return t&&r(t||C),window.addEventListener("themeColorChange",e),()=>{window.removeEventListener("themeColorChange",e)}}),[]);const i=n.useCallback((async o=>{if(!o)return!1;try{const i=document.createElement("div");i.innerHTML=o.innerHTML;let l=t;const s=getComputedStyle(document.documentElement).getPropertyValue("--themeColor").trim();s&&(l=s);const a=document.createElement("style");a.textContent=`\n        * {\n          --themeColor: ${l} !important;\n        }\n      `,i.appendChild(a);const d=i.getElementsByTagName("blockquote");for(let e=0;e<d.length;e++)d[e].style.borderLeftColor=l;const u=i.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let e=0;e<u.length;e++)u[e].style.color=l;const p=i.querySelectorAll("strong");for(let e=0;e<p.length;e++){const t=p[e];t instanceof HTMLElement&&(t.style.color=l)}i.style.position="fixed",i.style.left="-9999px",i.style.top="0",document.body.appendChild(i);let h=!1;try{await navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([i.innerHTML],{type:"text/html"}),"text/plain":new Blob([i.textContent||""],{type:"text/plain"})})]),h=!0}catch(n){try{i.contentEditable="true";const e=window.getSelection();if(e){const t=document.createRange();t.selectNodeContents(i),e.removeAllRanges(),e.addRange(t),h=document.execCommand("copy"),e.removeAllRanges()}}catch(r){}}if(document.body.removeChild(i),h)return c.success(e("copy.success")),!0;throw new Error("All copy methods failed")}catch(i){return c.error(e("copy.error")),!1}}),[e,t]);return{handleCopy:n.useCallback((async(t,o)=>{try{if(t&&!t.isCollapsed){const e=t.getRangeAt(0).cloneContents(),o=document.createElement("div");return o.appendChild(e),await i(o)}return await i(document.getElementById(o))}catch(n){return c.error(e("copy.error")),!1}}),[i,e]),copyToClipboard:i}})(),{selection:a,currentIndex:d}=p();return r.jsx("footer",{className:"fixed bottom-0 left-0 right-0 z-20 bg-white border-t border-gray-200 bg-opacity-100",children:r.jsxs("div",{className:"flex items-center h-12 justify-between",children:[r.jsx("div",{className:"flex justify-center",children:r.jsxs("div",{className:"h-8 px-2 text-gray-600 flex items-center justify-center text-xs",children:[r.jsx(i,{className:"mr-1 text-gray-500"}),e.length,t("footer.wordCount"),", ",t("footer.readingTime"),Math.round(e.length/100),t("footer.minutes")]})}),r.jsxs("div",{className:"px-4 flex space-x-2",children:[r.jsxs("button",{onClick:()=>{s(window.getSelection(),"preview-content")},className:"h-8 px-2 bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-700 text-white rounded shadow-md hover:shadow-lg active:shadow transform active:translate-y-0.5 transition-all flex items-center justify-center text-xs",title:t("contentPreview.copy"),children:[r.jsxs("svg",{className:"w-4 h-4 mr-1",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[r.jsx("path",{d:"M16 12.9V17.1C16 20.6 14.6 22 11.1 22H6.9C3.4 22 2 20.6 2 17.1V12.9C2 9.4 3.4 8 6.9 8H11.1C14.6 8 16 9.4 16 12.9Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 6.9V11.1C22 14.6 20.6 16 17.1 16H16V12.9C16 9.4 14.6 8 11.1 8H8V6.9C8 3.4 9.4 2 12.9 2H17.1C20.6 2 22 3.4 22 6.9Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),t("contentPreview.copy")]}),r.jsxs("button",{onClick:()=>{const e=document.getElementById("preview-content");if(e){const o=new Date,n=o.getFullYear().toString()+(o.getMonth()+1).toString().padStart(2,"0")+o.getDate().toString().padStart(2,"0"),r=a.fieldName||t("common.report"),i=d>=0?d+1:1,l={margin:1,filename:`${r.replace(/[/\\?%*:|"<>]/g,"-")}_${i}_${n}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"letter",orientation:"portrait"},pagebreak:{mode:"css",before:".page-break-before"}};g().set(l).from(e).save()}},className:"h-8 px-2 bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-700 text-white rounded shadow-md hover:shadow-lg active:shadow transform active:translate-y-0.5 transition-all flex items-center justify-center text-xs",title:t("footer.exportPdf"),children:[r.jsx(l,{className:"w-4 h-4 mr-1"}),t("footer.exportPdfButton")]})]})]})})},j=[{id:"wechat",name:"默认主题",description:"微信公众号文章样式",styles:"wechat-template",options:{base:{themeColor:"var(--themeColor, rgb(0, 0, 0))",fontFamily:'\'Source Han Sans\', -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif',textAlign:"left",lineHeight:"2",padding:"1rem 1.5rem",maxWidth:"100%",margin:"0 auto",wordBreak:"break-word",whiteSpace:"pre-wrap",fontSize:"15px",color:"#333"},block:{h1:{display:"block",padding:"0 1em 0.5em 1em",borderBottom:"2px solid var(--themeColor)",margin:"2em auto 1em",color:"var(--themeColor)",fontSize:"1.2em",fontWeight:"bold",textAlign:"center",textDecoration:"none",pageBreakInside:"avoid"},h2:{display:"block",padding:"0 0.2em 0.5em 0.2em",margin:"2em auto 2em",color:"var(--themeColor)",borderBottom:"2px solid var(--themeColor)",fontSize:"1.2em",fontWeight:"bold",textAlign:"center",textDecoration:"none",pageBreakInside:"avoid"},h3:{paddingLeft:"12px",borderLeft:"4px solid var(--themeColor)",margin:"2em 8px 0.75em 0",color:"var(--themeColor)",fontSize:"1.1em",fontWeight:"bold",lineHeight:"1.2",pageBreakInside:"avoid"},h4:{margin:"2em 8px 0.5em",color:"var(--themeColor)",fontSize:"1em",fontWeight:"bold",pageBreakInside:"avoid"},h5:{margin:"1.5em 8px 0.5em",color:"var(--themeColor)",fontSize:"1em",fontWeight:"bold",pageBreakInside:"avoid"},h6:{margin:"1.5em 8px 0.5em",fontSize:"1em",color:"var(--themeColor)",pageBreakInside:"avoid"},p:{fontSize:"var(--fontSize)",margin:"1.5em 8px",letterSpacing:"0.1em",color:"hsl(var(--foreground))",textAlign:"justify",pageBreakInside:"avoid"},blockquote:{fontStyle:"normal",padding:"1em",borderLeft:"4px solid var(--themeColor)",borderRadius:"6px",color:"rgba(0,0,0,0.5)",background:"var(--blockquote-background)",margin:"0 0 1em 0",pageBreakInside:"avoid"},code_pre:{fontSize:"14px",overflowX:"auto",borderRadius:"8px",padding:"1em",lineHeight:"1.5",margin:"10px 8px",pageBreakInside:"avoid"},code:{margin:"0",fontFamily:"Menlo, Operator Mono, Consolas, Monaco, monospace"},image:{display:"block",width:"100% !important",margin:"0.1em auto 0.5em",borderRadius:"4px"},ol:{paddingLeft:"1em",color:"hsl(var(--foreground))"},ul:{listStyle:"circle",paddingLeft:"1em",color:"hsl(var(--foreground))"},footnotes:{margin:"0.5em 8px",fontSize:"80%",color:"hsl(var(--foreground))"},table:{textAlign:"center",margin:"1em 8px",color:"hsl(var(--foreground))"},thead:{background:"rgba(0, 0, 0, 0.05)",fontWeight:"bold",color:"hsl(var(--foreground))"},td:{border:"1px solid #dfdfdf",padding:"0.25em 0.5em",color:"#3f3f3f"}},inline:{listitem:{display:"block",margin:"0.2em 8px",color:"hsl(var(--foreground))",pageBreakInside:"avoid"},codespan:{fontSize:"90%",color:"#333333",background:"rgba(27,31,35,.05)",padding:"3px 5px",borderRadius:"4px"},em:{fontStyle:"italic",fontSize:"inherit"},link:{color:"#576b95"},strong:{color:"var(--themeColor)",fontWeight:"bold",fontSize:"inherit"},footnote:{fontSize:"12px",color:"hsl(var(--foreground))"}}},transform:e=>e}];function $({previewRef:e,selectedTemplate:t,isConverting:o,previewContent:i,codeTheme:l}){var a,d;const c=n.useRef(null),{handlePreviewScroll:u}=(()=>{const e=n.useRef(!1),t=n.useRef();return{handleEditorScroll:n.useCallback((o=>{var n;if(e.current)return;const r=o.currentTarget,i=null==(n=document.querySelector(".preview-container"))?void 0:n.querySelector(".flex-1.overflow-y-auto");if(i){e.current=!0;try{const e=r.scrollTop/(r.scrollHeight-r.clientHeight)*(i.scrollHeight-i.clientHeight);i.scrollTop=e}finally{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e.current=!1}),50)}}}),[]),handlePreviewScroll:n.useCallback((o=>{if(e.current)return;const n=o.currentTarget,r=document.querySelector(".editor-container textarea");if(r){e.current=!0;try{const e=n.scrollTop/(n.scrollHeight-n.clientHeight)*(r.scrollHeight-r.clientHeight);r.scrollTop=e}finally{t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e.current=!1}),50)}}}),[])}})(),p=(h=i)?h.replace(/\[object Object\]/g,""):"";var h;return r.jsx("div",{id:"preview-content",ref:e,className:b("preview-container bg-white h-full w-full flex flex-col","markdown-body relative",t&&(null==(a=j.find((e=>e.id===t)))?void 0:a.styles),`code-theme-${l}`),children:r.jsx("div",{ref:c,className:"flex-1 overflow-y-auto",onScroll:u,children:o?r.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-8",children:[r.jsx(s,{className:"h-6 w-6 animate-spin text-muted-foreground"}),r.jsx("span",{className:"text-sm text-muted-foreground",children:"正在生成预览..."})]}):r.jsx("div",{className:b("preview-content py-4 px-6 w-full max-w-none",t&&(null==(d=j.find((e=>e.id===t)))?void 0:d.styles)),dangerouslySetInnerHTML:{__html:p}})})})}function z(e={}){return e?Object.entries(e).filter((([e,t])=>null!=t)).map((([e,t])=>{if("@media (max-width: 768px)"===e)return"";const o=e.replace(/([A-Z])/g,"-$1").toLowerCase();return"number"!=typeof t||o.includes("line-height")||(t=`${t}px`),`${o}: ${String(t)}`})).filter(Boolean).join(";"):""}function T(e){const t=y.find((t=>t.id===e));return t?{background:t.theme.background,color:t.theme.text}:{}}function H(e,t){if("string"==typeof e)return e;return`<span style="${function(e,t){const o=y.find((t=>t.id===e));if(!o)return"";const n=o.theme[t];return n?`color: ${n};`:""}(t,e.type)}">${Array.isArray(e.content)?e.content.map((e=>H(e,t))).join(""):H(e.content,t)}</span>`}class L{constructor(e){t(this,"renderer"),t(this,"options"),this.options=e,this.renderer=new x.Renderer,this.initializeRenderer()}initializeRenderer(){this.renderer.heading=(e,t)=>{var o,n;const r=`h${t}`,i=z({...(null==(o=this.options.block)?void 0:o[r])||{},color:null==(n=this.options.base)?void 0:n.themeColor});return 3===t&&(e=`▍ ${e}`),`<h${t}${i?` style="${i}"`:""}>${e}</h${t}>`},this.renderer.paragraph=e=>{var t,o,n;const r=z({...(null==(t=this.options.block)?void 0:t.p)||{},fontSize:null==(o=this.options.base)?void 0:o.fontSize,lineHeight:null==(n=this.options.base)?void 0:n.lineHeight});return`<p${r?` style="${r}"`:""}>${e}</p>`},this.renderer.blockquote=e=>{var t,o;const n=z({...(null==(t=this.options.block)?void 0:t.blockquote)||{},borderLeft:`4px solid ${(null==(o=this.options.base)?void 0:o.themeColor)||"#1a1a1a"}`});return`<blockquote${n?` style="${n}"`:""}>${e}</blockquote>`},this.renderer.code=(e,t)=>{var o;const n=z({...(null==(o=this.options.block)?void 0:o.code_pre)||{}});return`<pre${n?` style="${n}"`:""}><code class="language-${t||""}">${function(e,t,o){if(!t||!v.languages[t])return e;try{const n=v.languages[t],r=e.split("\n"),i=8*r.length.toString().length+20;return r.map(((e,t)=>{const r=v.tokenize(e,n).map((e=>H(e,o))).join("");return`<div class="code-line"><span class="line-number" style="width:${i}px;color:#999;padding-right:1em;text-align:right;display:inline-block;user-select:none;">${t+1}</span>${r}</div>`})).join("\n")}catch(n){return e}}(e,t||"",this.options.codeTheme||"github")}</code></pre>`},this.renderer.codespan=e=>{var t;const o=z((null==(t=this.options.inline)?void 0:t.codespan)||{});return`<code${o?` style="${o}"`:""}>${e}</code>`},this.renderer.em=e=>{var t;const o=z({...(null==(t=this.options.inline)?void 0:t.em)||{},fontStyle:"italic"});return`<em${o?` style="${o}"`:""}>${e}</em>`},this.renderer.strong=e=>{var t,o;const n=z({...(null==(t=this.options.inline)?void 0:t.strong)||{},color:null==(o=this.options.base)?void 0:o.themeColor,fontWeight:"bold"});return`<strong${n?` style="${n}"`:""}>${e}</strong>`},this.renderer.link=(e,t,o)=>{var n;const r=z((null==(n=this.options.inline)?void 0:n.link)||{});return`<a href="${e}"${t?` title="${t}"`:""}${r?` style="${r}"`:""}>${o}</a>`},this.renderer.image=(e,t,o)=>{var n;const r=z({...(null==(n=this.options.block)?void 0:n.image)||{},maxWidth:"100%",display:"block",margin:"0.5em auto"});return`<img src="${e}"${t?` title="${t}"`:""} alt="${o}"${r?` style="${r}"`:""}>`},this.renderer.list=(e,t,o)=>{var n;const r=t?"ol":"ul",i=z({...(null==(n=this.options.block)?void 0:n[r])||{},listStyle:t?"decimal":"disc",paddingLeft:"2em",marginBottom:"16px"});return`<${r}${t&&1!==o?` start="${o}"`:""}${i?` style="${i}"`:""}>${e}</${r}>`},this.renderer.listitem=(e,t,o)=>{var n;const r=z({...(null==(n=this.options.inline)?void 0:n.listitem)||{},marginBottom:"8px",display:"list-item"});let i=e;if(t){i=`<input type="checkbox"${o?' checked=""':""} disabled="" /> `+i}return`<li${r?` style="${r}"`:""}>${i}</li>`},this.renderer.del=e=>{var t;const o=z((null==(t=this.options.inline)?void 0:t.del)||{});return`<del${o?` style="${o}"`:""}>${e}</del>`}}getRenderer(){return this.renderer}}class N{constructor(e){t(this,"options"),t(this,"renderer"),this.options=e,this.renderer=new L(e),this.initializeMarked()}initializeMarked(){x.setOptions({gfm:!0,breaks:!0,pedantic:!1,renderer:this.renderer.getRenderer()}),x.use({breaks:!0,gfm:!0,walkTokens(e){if("list"===e.type){e.items.forEach((e=>{e.task&&(e.checked=!!e.checked)}))}}})}async parse(e){const t=this.preprocessMarkdown(e),o=await Promise.resolve(x(t)),n=function(e={}){if(!e)return"";const t=[];return e.lineHeight&&t.push(`line-height: ${e.lineHeight}`),e.fontSize&&t.push(`font-size: ${e.fontSize}`),e.textAlign&&t.push(`text-align: ${e.textAlign}`),e.themeColor&&t.push(`--theme-color: ${e.themeColor}`),t.join(";")}(this.options.base);return n?`<section style="${n}">${o}</section>`:o}preprocessMarkdown(e){return e.replace(/<text_tag\s+color='([^']+)'>(.*?)<\/text_tag>/g,((e,t,o)=>this.renderTextTag(o,t))).replace(new RegExp("(?<!<[^>]*)\\*\\*([^*]+)\\*\\*(?![^<]*>)","g"),"<strong>$1</strong>").replace(/^(?!\s*```)([ \t]*)-\s+/gm,"$1• ")}renderTextTag(e,t){return`<span style="color: ${{purple:"#8b5cf6",green:"#10b981",blue:"#3b82f6",red:"#ef4444",yellow:"#f59e0b",gray:"#6b7280",indigo:"#6366f1",pink:"#ec4899"}[t]||t}; font-weight: bold; font-family: 'Source Han Sans TC', sans-serif;">${e}</span>`}}const R={base:{fontSize:"16px",lineHeight:"1.75",color:"#333333",padding:"20px",themeColor:"#1a1a1a"},block:{h1:{fontSize:"24px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0",borderBottom:"2px solid #1a1a1a"},h2:{fontSize:"20px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0",borderBottom:"1px solid #1a1a1a"},h3:{fontSize:"18px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0"},h4:{fontSize:"16px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0"},h5:{fontSize:"14px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0"},h6:{fontSize:"14px",fontWeight:"bold",lineHeight:1.5,margin:"24px 0 16px 0",padding:"0"},p:{margin:"16px 0",lineHeight:1.75},blockquote:{margin:"16px 0",padding:"0 16px",color:"#666666",borderLeft:"4px solid #dddddd",backgroundColor:"#f5f5f5"},code_pre:{margin:"16px 0",padding:"16px",borderRadius:"4px",backgroundColor:"#f6f8fa",fontSize:"14px",lineHeight:1.5,overflowX:"auto"}},inline:{codespan:{padding:"2px 4px",borderRadius:"4px",backgroundColor:"#f6f8fa",fontSize:"14px"},strong:{fontWeight:"bold"},em:{fontStyle:"italic"},del:{textDecoration:"line-through"},link:{color:"#0366d6",textDecoration:"none"}}};const B=({value:e,selectedTemplate:t,styleOptions:o,codeTheme:r})=>{const[i,l]=n.useState(!1),[s,a]=n.useState(""),d=n.useCallback((async()=>{var n,i,l,s,a,d,c,u,p,h,m,f,g,v,x,b,y,k,w,C,S,$,z,H,L,B,E,I,A,M,P,W,_,q,D,O,V,F,G,K,Y,Z,X,J,U,Q,ee,te,oe,ne,re,ie,le,se,ae,de,ce,ue,pe,he,me,fe,ge,ve,xe,be,ye,ke,we,Ce,Se,je,$e;if(!e)return"";const ze=j.find((e=>e.id===t)),Te={base:{...(null==(n=null==ze?void 0:ze.options)?void 0:n.base)||{},...o.base},block:{...(null==(i=null==ze?void 0:ze.options)?void 0:i.block)||{},...o.block||{},code_pre:{...(null==(s=null==(l=null==ze?void 0:ze.options)?void 0:l.block)?void 0:s.code_pre)||{},...(null==(a=o.block)?void 0:a.code_pre)||{},...T(r)},h1:{...(null==(c=null==(d=null==ze?void 0:ze.options)?void 0:d.block)?void 0:c.h1)||{},...(null==(u=o.block)?void 0:u.h1)||{},fontSize:(null==(h=null==(p=o.block)?void 0:p.h1)?void 0:h.fontSize)||(null==(g=null==(f=null==(m=null==ze?void 0:ze.options)?void 0:m.block)?void 0:f.h1)?void 0:g.fontSize)||"24px",color:(null==(v=o.base)?void 0:v.themeColor)||(null==(b=null==(x=null==ze?void 0:ze.options)?void 0:x.base)?void 0:b.themeColor)||"#1a1a1a",...(null==(w=null==(k=null==(y=null==ze?void 0:ze.options)?void 0:y.block)?void 0:k.h1)?void 0:w.borderBottom)&&{borderBottom:`2px solid ${(null==(C=o.base)?void 0:C.themeColor)||(null==($=null==(S=null==ze?void 0:ze.options)?void 0:S.base)?void 0:$.themeColor)||"#1a1a1a"}`}},h2:{...(null==(H=null==(z=null==ze?void 0:ze.options)?void 0:z.block)?void 0:H.h2)||{},...(null==(L=o.block)?void 0:L.h2)||{},fontSize:(null==(E=null==(B=o.block)?void 0:B.h2)?void 0:E.fontSize)||(null==(M=null==(A=null==(I=null==ze?void 0:ze.options)?void 0:I.block)?void 0:A.h2)?void 0:M.fontSize)||"20px",color:(null==(P=o.base)?void 0:P.themeColor)||(null==(_=null==(W=null==ze?void 0:ze.options)?void 0:W.base)?void 0:_.themeColor)||"#1a1a1a",...(null==(O=null==(D=null==(q=null==ze?void 0:ze.options)?void 0:q.block)?void 0:D.h2)?void 0:O.borderBottom)&&{borderBottom:`2px solid ${(null==(V=o.base)?void 0:V.themeColor)||(null==(G=null==(F=null==ze?void 0:ze.options)?void 0:F.base)?void 0:G.themeColor)||"#1a1a1a"}`}},h3:{...(null==(Y=null==(K=null==ze?void 0:ze.options)?void 0:K.block)?void 0:Y.h3)||{},...(null==(Z=o.block)?void 0:Z.h3)||{},color:(null==(X=o.base)?void 0:X.themeColor)||(null==(U=null==(J=null==ze?void 0:ze.options)?void 0:J.base)?void 0:U.themeColor)||"#1a1a1a",fontSize:"1.1em",fontWeight:"bold",lineHeight:"1.5"},p:{...(null==(ee=null==(Q=null==ze?void 0:ze.options)?void 0:Q.block)?void 0:ee.p)||{},...(null==(te=o.block)?void 0:te.p)||{},fontSize:(null==(oe=o.base)?void 0:oe.fontSize)||(null==(re=null==(ne=null==ze?void 0:ze.options)?void 0:ne.base)?void 0:re.fontSize)||"15px",lineHeight:(null==(ie=o.base)?void 0:ie.lineHeight)||(null==(se=null==(le=null==ze?void 0:ze.options)?void 0:le.base)?void 0:se.lineHeight)||2},ol:{...(null==(de=null==(ae=null==ze?void 0:ze.options)?void 0:ae.block)?void 0:de.ol)||{},...(null==(ce=o.block)?void 0:ce.ol)||{},fontSize:(null==(ue=o.base)?void 0:ue.fontSize)||(null==(he=null==(pe=null==ze?void 0:ze.options)?void 0:pe.base)?void 0:he.fontSize)||"15px"},ul:{...(null==(fe=null==(me=null==ze?void 0:ze.options)?void 0:me.block)?void 0:fe.ul)||{},...(null==(ge=o.block)?void 0:ge.ul)||{},fontSize:(null==(ve=o.base)?void 0:ve.fontSize)||(null==(be=null==(xe=null==ze?void 0:ze.options)?void 0:xe.base)?void 0:be.fontSize)||"15px"}},inline:{...(null==(ye=null==ze?void 0:ze.options)?void 0:ye.inline)||{},...o.inline||{},listitem:{...(null==(we=null==(ke=null==ze?void 0:ze.options)?void 0:ke.inline)?void 0:we.listitem)||{},...(null==(Ce=o.inline)?void 0:Ce.listitem)||{},fontSize:(null==(Se=o.base)?void 0:Se.fontSize)||(null==($e=null==(je=null==ze?void 0:ze.options)?void 0:je.base)?void 0:$e.fontSize)||"15px"}},codeTheme:r},He=await async function(e,t=R){const o={base:{...R.base,...t.base},block:{...R.block,...t.block},inline:{...R.inline,...t.inline},codeTheme:t.codeTheme||"github"},n=new N(o);return await n.parse(e)}(e,Te);if(!(null==ze?void 0:ze.transform))return He;try{const e=ze.transform(He);if(e){if("object"==typeof e){const t=e;if(t.html)return t.html;if(t.content)return t.content;try{return JSON.stringify(e,null,2)}catch(Le){return He}}return e||He}return He}catch(Ne){return He}}),[e,t,o,r]);return n.useEffect((()=>{(async()=>{if(e){l(!0);try{const e=await d(),t="string"==typeof e?e.replace(/\[object Object\]/g,""):"";a(t),await new Promise((e=>setTimeout(e,50)))}catch(t){}finally{l(!1)}}else a("")})()}),[e,t,o,r,d]),{isConverting:i,previewContent:s,getPreviewContent:d}},E=n.createContext(void 0),I=({content:e,codeTheme:t="github"})=>{const{t:i}=o(),{selectedTemplate:l}=(()=>{const e=n.useContext(E);if(void 0===e)throw new Error("useTemplateContext must be used within a TemplateProvider");return e})(),s=n.useRef(null),a=j.find((e=>e.id===l)),{isConverting:d,previewContent:c}=B({value:e,selectedTemplate:l,styleOptions:(null==a?void 0:a.options)||R,codeTheme:t});return e?r.jsx("div",{className:"h-full w-full mt-20",children:r.jsx($,{previewRef:s,previewContent:c,isConverting:d,codeTheme:t,selectedTemplate:l})}):r.jsx("div",{className:"h-full flex items-center justify-center bg-app-card rounded-lg shadow-sm mt-20",children:r.jsxs("div",{className:"text-center my-10",children:[r.jsx("p",{className:"text-app font-bold mb-2",children:i("contentPreview.empty")}),r.jsx("p",{className:"text-sm text-app opacity-60",children:i("contentPreview.empty")})]})})},A=n.createContext(void 0);var M=(e=>(e.LIGHT="LIGHT",e.DARK="DARK",e))(M||{});const P=({children:e})=>{const t=(()=>{const[e,t]=n.useState(M.LIGHT);return n.useEffect((()=>{(async()=>{try{const e=await w.bridge.getTheme();t(e)}catch(e){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?M.DARK:M.LIGHT;t(o)}})();const e=w.bridge.onThemeChange((e=>{const o=e.data.theme;t(o)})),o=window.matchMedia("(prefers-color-scheme: dark)"),n=e=>{if(!w.bridge){const o=e.matches?M.DARK:M.LIGHT;t(o)}};return o.addEventListener("change",n),()=>{null==e||e(),o.removeEventListener("change",n)}}),[]),{theme:e,isDarkMode:e===M.DARK}})(),{theme:o}=t;return n.useEffect((()=>{const e=document.documentElement,t={LIGHT:{"--app-bg-color":"#ffffff","--app-text-color":"#213547","--app-border-color":"#dee0e3","--app-primary-color":"#333333","--app-secondary-bg":"#f5f5f5","--app-card-bg":"#ffffff","--app-hover-bg":"#f0f0f0"},DARK:{"--app-bg-color":"#1a1a1a","--app-text-color":"#ffffff","--app-border-color":"#333333","--app-primary-color":"#ffffff","--app-secondary-bg":"#2a2a2a","--app-card-bg":"#262626","--app-hover-bg":"#3a3a3a"}}[o];Object.entries(t).forEach((([t,o])=>{e.style.setProperty(t,o)})),document.body.classList.remove("theme-light","theme-dark"),document.body.classList.add(`theme-${o.toLowerCase()}`)}),[o]),r.jsx(A.Provider,{value:t,children:e})},W=({children:e})=>{const[t,o]=n.useState("wechat");return r.jsx(E.Provider,{value:{selectedTemplate:t,setSelectedTemplate:o},children:e})};function _(){const{t:e}=o(),{theme:t}=(()=>{const e=n.useContext(A);if(!e)throw new Error("useThemeContext must be used within a ThemeProvider");return e})(),{selection:i,recordIds:l,currentIndex:s,switchRecord:a,loading:d,error:c}=p();return c?r.jsx(W,{children:r.jsxs("div",{className:"h-screen w-screen flex flex-col text-app bg-app","data-theme":t.toLowerCase(),children:[r.jsx(u,{position:"top-center",richColors:!0}),r.jsx(h,{message:c.message||e("error.message")})]})}):r.jsx(W,{children:r.jsxs("div",{className:"h-screen w-screen flex flex-col text-app bg-app","data-theme":t.toLowerCase(),children:[r.jsx(u,{position:"top-center",richColors:!0}),r.jsx(m,{recordIdsLength:l.length,currentIndex:s,onSwitchRecord:e=>{a(e)}}),r.jsx("main",{className:"flex-1 bg-app-secondary overflow-auto",children:r.jsx("div",{className:"w-full h-full",children:d?r.jsx(f,{}):r.jsx(I,{content:i.content,currentIndex:s,recordIdsLength:l.length})})}),r.jsx(S,{content:i.content}),r.jsx("div",{className:"h-14"})]})})}function q(){const[e,t]=n.useState(!1),[o,i]=n.useState(null);return n.useEffect((()=>{const e=setTimeout((()=>{k("en"),setTimeout((()=>{i(r.jsx(D,{}))}),1e3)}),5e3);return w.bridge.getLanguage().then((o=>{clearTimeout(e);const n=["en","zh","ja"].includes(o)?o:"zh";k(n),t(!0)})).catch((()=>{clearTimeout(e),k("zh"),t(!0)})),()=>clearTimeout(e)}),[]),e?r.jsx(d.StrictMode,{children:r.jsx(P,{children:r.jsx(_,{})})}):o}function D(){const{t:e}=o();return r.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-8 text-center",children:r.jsxs("div",{className:"max-w-md mx-auto",children:[r.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),r.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:e("error.title")}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:e("load_error.1")}),r.jsx("div",{className:"space-y-3",children:r.jsxs("a",{href:"https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=3cbueaf7-a6b9-44ca-96eb-d490646326c5",target:"_blank",rel:"noopener noreferrer",className:"inline-block px-4 py-2 bg-indigo-500 text-white rounded-md hover:bg-indigo-600 transition-colors",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 inline",viewBox:"0 0 20 20",fill:"currentColor",children:[r.jsx("path",{d:"M9 2a2 2 0 00-2 2v8a2 2 0 002 2h6a2 2 0 002-2V6.414A2 2 0 0016.414 5L14 2.586A2 2 0 0012.586 2H9z"}),r.jsx("path",{d:"M3 8a2 2 0 012-2v10h8a2 2 0 01-2 2H5a2 2 0 01-2-2V8z"})]}),e("official.doclink")]})})]})})}a.createRoot(document.getElementById("root")).render(r.jsx(q,{}));
//# sourceMappingURL=index-b98cc177.js.map
