# 版本更新记录

## v2.1.0 (2026-01-20)
### 🎉 主要功能
- **一键保存为附件** - 新增“保存到附件”功能，生成的 PDF 可直接保存回飞书多维表格字段中。
- **自动创建附件字段** - 当表格中不存在合适的附件字段时，系统会自动创建名为“PDF附件”的字段，实现开箱即用。
- **多附件追加** - 支持在一个记录中保存多个 PDF，系统会自动将新文件追加到现有附件列表中，避免覆盖。

### 🎨 视觉与体验优化
- **全新排版样式** - 升级为 Modern Slate 设计语言，优化字体层级与配色，提供更专业的报告阅读感。
- **高密度布局** - 优化了预览页面的留白与边距，自适应容器宽度，显著提升了在侧边栏使用时的信息展示密度。
- **一致性导出** - 深度同步了插件预览、本地打印和远程 PDF 导出的样式方案，确保“所见即所得”。

### ⚡ 性能与稳定性增强
- **极速响应** - 优化了飞书选区变化的监听逻辑，引入竞态条件控制，彻底解决了快速切换行时的卡顿与闪烁现象。
- **减少 API 请求** - 实现了字段信息缓存机制，提升了加载性能并降低了飞书 API 调用频率。
- **稳健上传逻辑** - 采用多级降级上传策略，确保附件保存功能在各种网络环境下都能稳定运行。

### 🛠️ 工程化改进
- **线上导出PDF服务集成** - 正式接入远程PDF导出服务，提供更稳定的跨平台导出能力。
- **国际化增强** - 补齐了 PDF 保存功能相关的中文、英文等多语言支持。


## v2.0.4 (2025-11-24)
### 🐛 问题修复
- **修复PDF导出公式显示问题** - 解决了数学公式中分数线错位、缺失的问题，优化了复杂公式在PDF中的渲染效果


## 🎉 v2.0.3 新功能：PDF导出序号配置(2025-11-07)
### 🎉 主要功能

- **序号配置选项** - 用户可以选择是否在PDF导出文件名中包含序号
- **默认不含序号** - 文件名更简洁，默认格式：{字段名}_{日期}.pdf
- **用户选择权** - 可通过按钮切换是否包含序号格式：{字段名}_{序号}_{日期}.pdf
- **配置持久化**  - 用户选择会自动保存到localStorage，下次使用时恢复

### 🎨 界面更新
- 在PDF导出弹窗中新增序号设置区域
- 提供"不含序号"和"包含序号"两个选项按钮
- 显示序号示例说明（如: _1）
- 支持实时预览文件名变化


## v2.0.2 (2025-09-30)
### 🎉 主要更新
- **PDF导出效果大幅提升** - 字体更清晰，表格更美观，不再出现内容缺失
- **界面样式优化** - 采用更现代的设计，阅读体验更佳
- **修复多个显示问题** - 解决了标题下划线、列表符号等显示异常


